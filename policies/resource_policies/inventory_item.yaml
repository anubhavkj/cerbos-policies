apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: inventory_item

  rules:
    # ALLOW: Emily can perform override adjustments (same-tenant only)
    - actions: ["inventory_view", inventory_adjust_counts_override"]
      effect: EFFECT_ALLOW
      roles: ["*"]
      condition:
        match:
          expr: request.resource.attr.tenant == request.principal.attr.tenant &&
                request.principal.attr.username == "emily"

    # ALLOW: Everyone can view (same-tenant only)
    - actions: ["inventory_view"]
      effect: EFFECT_ALLOW
      roles: ["*"]
      condition:
        match:
          expr: request.resource.attr.tenant == request.principal.attr.tenant
