apiVersion: api.cerbos.dev/v1
derivedRoles:
  name: role_hierarchy_scoped

  definitions:
    - name: user_role
      parentRoles: ["user"]
      condition:
        match:
          expr: request.principal.attr.tenant == request.resource.attr.tenant

    - name: specialist_role
      parentRoles: ["inventory_control_specialist"]
      condition:
        match:
          expr: request.principal.attr.tenant == request.resource.attr.tenant

    - name: manager_role
      parentRoles: ["warehouse_manager"]
      condition:
        match:
          expr: request.principal.attr.tenant == request.resource.attr.tenant

    - name: scm_role
      parentRoles: ["supply_chain_manager"]
      condition:
        match:
          expr: request.principal.attr.tenant == request.resource.attr.tenant
                && request.principal.attr.region == request.resource.attr.region

    - name: admin_role
      parentRoles: ["inventory_admin"]
      condition:
        match:
          expr: request.principal.attr.tenant == request.resource.attr.tenant
